
**Definición de 5 consultas que utilicen subconsultas, tanto escalares, como fila y de tabla.**
```sql
SELECT nombre, apellidos
FROM CLIENTE
WHERE contAcceso = (SELECT MAX(contAcceso) FROM CLIENTE);

SELECT nombre, email
FROM CLIENTE
WHERE falta = (SELECT MIN(falta) FROM CLIENTE);

SELECT G.codigo, G.nombre
FROM GIMNASIO G
WHERE G.codigo IN (
SELECT DISTINCT S.codGimnasio
FROM SALA S
JOIN RESERVA R ON S.id = R.idSala
);

SELECT nombre, apellidos
FROM CLIENTE C
WHERE EXISTS (
SELECT 1 FROM RESERVA R WHERE R.nifCliente = C.nif
);

SELECT T.nif, T.nombre, T.apellidos, T.email
FROM TRABAJADOR T
WHERE T.nif = (
SELECT D.nifMonitor
FROM DIRIGIR D
GROUP BY D.nifMonitor
ORDER BY COUNT(D.idClase) DESC
LIMIT 1
);
```

**Definición de 2 consultas que u2licen CTE**  

**Contar el número de accesos de los clientes**  
```sql
WITH contarAccesos AS (
SELECT nifCliente, COUNT(*) AS total_accesos
FROM `ACCESO`
GROUP BY nifCliente
)

SELECT c.nif, c.nombre, c.apellidos, a.total_accesos
FROM `CLIENTE` c
LEFT JOIN `contarAccesos` a ON c.nif = a.nifCliente
ORDER BY a.total_accesos DESC;
Clientes con mas reservas
WITH ReservaCliente AS (
SELECT r.nifCliente, COUNT(*) AS total_reservas
FROM RESERVA r
GROUP BY r.nifCliente
)

SELECT c.nif, c.nombre, c.apellidos, rp.total_reservas
FROM CLIENTE c
LEFT JOIN ReservaCliente rp ON c.nif = rp.nifCliente
ORDER BY rp.total_reservas DESC;
```
